<script>
const DashboardPage = {
  template: '#dashboard-page',
  setup(){
    const userStore = useUserStore();
    const customerStore = useCustomerStore();
    const snackbarStore = useSnackbarStore();
    const utilityStore = useUtilityStore();
    return { userStore, snackbarStore, customerStore, utilityStore};
  },
 computed: {   
    customerRequests() {
      return this.customerStore.getCustomerRequests.map(custR => ({
        customerName: custR.customerName,
        priority: custR.priority,
        deliveryDate: custR.deliveryDate,
        stage: custR.stage,
      }));
    },
    customerRequestHeaders() {
      const includedHeaders = ['customerName', 'priority', 'deliveryDate', 'stage']
      return this.customerStore.getCustomerRequestHeaders.filter(custRH => includedHeaders.includes(custRH.key));
    }
  },
  beforeMount() {
    //check if dropdown data is already loaded 
    this.customerStore.fetchCustomerRequestsIfEmpty()
    this.utilityStore.fetchDropdownOptionsIfEmpty()
  },
  methods: {
    logout(){
      this.userStore.logout()
      window.router.push({ path: "/" }).catch(() => {});

    }
  }
};
</script>