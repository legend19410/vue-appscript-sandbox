<script>
const UserPage = {
  template: '#users-page',
  components: { UsersTable },
  setup(){
    const userStore = useUserStore();
    const snackbarStore = useSnackbarStore();
    const utilityStore = useUtilityStore();

    const route = VueRouter.useRoute()
    const activeView = route.query.subView

    return { userStore, snackbarStore, utilityStore, activeView};
  },
  beforeMount() {
    this.utilityStore.fetchDropdownOptionsIfEmpty()
    this.switchView(this.activeView) 
  },
  data() {
    return {
      activeComponent: markRaw(UsersTable),
      userViewsMap: {
        'all-users': markRaw(UsersTable)
      }
    }
  },
  methods: {
    logout(){
      this.userStore.logout()
      window.router.push({ path: "/" }).catch(() => {});
    },
    switchView(componentViewName) {

      logger.log('Switching to User Component: ', componentViewName)

      if (this.userViewsMap[componentViewName]) {

        this.activeComponent = this.userViewsMap[componentViewName]
        logger.log('Active Component is: ', this.activeComponent)
        
      } else {
        logger.warn(`Component "${componentViewName}" not found in customerViewsMap`)
      }
    }
  }
};
</script>